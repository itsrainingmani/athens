{"version":3,"sources":["athens/devcards/db.cljs"],"mappings":"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","names":["athens.devcards.db/load-real-db!","c__23115__auto__","cljs.core.async.chan.cljs$core$IFn$_invoke$arity$1","cljs.core.async.impl.dispatch/run","f__23116__auto__","switch__23092__auto__","state_36462","state_val_36463","statearr-36464","inst_36425","inst_36426","inst_36427","cljs.core/PersistentHashMap","inst_36428","cljs.core.async.impl.ioc-helpers/take!","statearr-36465","inst_36458","statearr-36466","statearr-36467","inst_36430","inst_36435","inst_36436","inst_36437","inst_36438","cljs.core/PROTOCOL_SENTINEL","inst_36439","statearr-36468","statearr-36469","inst_36453","inst_36455","inst_36456","statearr-36470","inst_36432","inst_36433","cljs.core/not","statearr-36471","statearr-36472","statearr-36473","inst_36451","inst_36452","cljs.core.get.cljs$core$IFn$_invoke$arity$2","statearr-36474","statearr-36475","statearr-36476","inst_36448","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","statearr-36477","inst_36446","statearr-36478","statearr-36479","inst_36460","cljs.core.async.impl.ioc-helpers/return-chan","statearr-36480","inst_36443","statearr-36481","statearr-36482","state-machine__23093__auto__","ret-value__23094__auto__","result__23095__auto__","cljs.core/keyword-identical?","e36483","js/Object","ex__23096__auto__","statearr-36484","cljs.core.async.impl.ioc-helpers/process-exception","state__23117__auto__","statearr-36485","cljs.core.async.impl.ioc-helpers/USER-START-IDX","cljs.core.async.impl.ioc-helpers/run-state-machine-wrapped","cljs_http.client.get.cljs$core$IFn$_invoke$arity$variadic","athens.db/athens-url","posh.reagent/transact!","athens.db/dsdb","athens.db/str-to-db-tx","js/alert","athens.devcards.db/load-real-db-button","pressed?","reagent.core.atom.cljs$core$IFn$_invoke$arity$1","handler","cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$2","cljs.core/deref","athens.devcards.buttons/button-primary","athens.devcards.db/reset-db-button","datascript.core.reset_conn_BANG_.cljs$core$IFn$_invoke$arity$2","datascript.core/empty-db","athens.db/schema"],"sourcesContent":["(ns athens.devcards.db\n  (:require\n    [athens.db :as db]\n    [athens.devcards.buttons :refer [button-primary]]\n    [cljs-http.client :as http]\n    [cljs.core.async :refer [go <!]]\n    [cljsjs.react]\n    [cljsjs.react.dom]\n    [datascript.core :as d]\n    [devcards.core :refer [defcard defcard-rg]]\n    [posh.reagent :refer [transact!]]\n    [reagent.core :as r]))\n\n\n;;; Components\n\n\n(defn load-real-db!\n  []\n  (go\n    (let [res (<! (http/get db/athens-url {:with-credentials? false}))\n          {:keys [success body]} res]\n      (if success\n        (transact! db/dsdb (db/str-to-db-tx body))\n        (js/alert \"Failed to retrieve data from GitHub\")))))\n\n\n(defn load-real-db-button\n  []\n  (let [pressed? (r/atom false)\n        handler (fn []\n                  (swap! pressed? not)\n                  (load-real-db!))]\n    (fn []\n      [button-primary {:disabled @pressed?\n                       :on-click-fn handler\n                       :label \"Load Real Data\"}])))\n\n\n(defn reset-db-button\n  []\n  (fn []\n    [button-primary {:on-click-fn #(d/reset-conn! db/dsdb (d/empty-db db/schema))\n                     :label       \"Reset DB\"}]))\n\n\n;;; Devcards\n\n\n(defcard-rg Load-Real-DB\n  \"Downloads the ego db. Takes a few seconds. Can only press once.\"\n  [load-real-db-button])\n\n\n(defcard-rg Reset-DB\n  [reset-db-button])\n\n\n(defcard athens-dsdb\n  \"The main Athens dsdb:\"\n  db/dsdb)\n"]}